{% extends "layouts/pieceDetailsLayout.njk" %}

{%- from 'macros/metadata.njk' import descriptiveMetaData -%}
{%- from 'macros/piece-details.njk' import relatedContent, tags, websiteCTA -%}
{%- from 'macros/piece-link-list.njk' import sortedPieceLinkList -%}
{%- from 'options/options.njk' import fixedRichTextOptions -%}


{%- set piece = data.piece -%}
{%- set hasProfilePic = piece.profilePic.items|length > 0 -%}

{% block title %}
  {{ piece.title }} - People | Arts et MÃ©dias
{% endblock %}

{% block metadata %}
  {{
    descriptiveMetaData({
      title: piece.title,
      description: piece.shortDescription,
      heroImage: piece.profilePic,
      url: piece._url,
      baseUrl: data.baseUrl
    })
  }}
{% endblock %}

{% block mainAdditionalClasses %}person-details{% endblock %}

{% block pageContent %}
  <h2 class="sr-only">Description</h2>

  {%- if hasProfilePic -%}
    <div class="profile-pic-container">
      {% include "partials/people/profile-pic-en.njk" %}
    </div>
  {%- endif -%}

  <div class="description rich-description">
    {{
      apos.singleton(
        piece,
        'description',
        'apostrophe-rich-text',
        fixedRichTextOptions
      )
    }}
  </div>

  {{ websiteCTA(piece) }}

  <hr class="separator"/>

  {%- if piece._originalAuthor|length -%}
    <dl class="piece-props-list">
      <dt>Author of the Following Articles</dt>
      <dd>{{ sortedPieceLinkList(piece._originalAuthor) }}</dd>
    </dl>
  {%- endif -%}

  {%- if piece._author|length -%}
    {# books #}
    <dl class="piece-props-list">
      <dt>Author of the Following Books</dt>
      <dd>{{ sortedPieceLinkList(piece._author) }}</dd>
    </dl>
  {%- endif -%}

  {%- if piece._relatedPeople -%}
    {# workshops #}
    {%- set workshops = apos.aemPieces.getRelatedWorkshops(piece) -%}
    {%- if workshops|length -%}
      <dl class="piece-props-list">
        <dt>Related Workshops</dt>
        <dd>{{ sortedPieceLinkList(workshops) }}</dd>
      </dl>
    {%- endif -%}

    {# collectives #}
    {%- set collectives = apos.aemPieces.getRelatedCollectives(piece)-%}
    {%- if collectives|length -%}
      <dl class="piece-props-list">
        <dt>Related Collectives</dt>
        <dd>{{ sortedPieceLinkList(collectives) }}</dd>
      </dl>
    {%- endif -%}

    {# galleries #}
    {%- set galleries = apos.aemPieces.getRelatedGalleries(piece)-%}
    {%- if galleries|length -%}
      <dl class="piece-props-list">
        <dt>Related Galleries</dt>
        <dd>{{ sortedPieceLinkList(galleries) }}</dd>
      </dl>
    {%- endif -%}

    {# artCenters #}
    {%- set artCenters = apos.aemPieces.getRelatedArtCenters(piece)-%}
    {%- if artCenters|length -%}
      <dl class="piece-props-list">
        <dt>Related Art Centers</dt>
        <dd>{{ sortedPieceLinkList(artCenters) }}</dd>
      </dl>
    {%- endif -%}

    {# academic institutions #}
    {%-
      set academicInstitutions = apos.aemPieces.getWithTags(
        piece._relatedPeople,
        [
          'academic institution',
          'higher education',
          'university'
        ]
      )
    -%}
    {%- if academicInstitutions|length -%}
      <dl class="piece-props-list">
        <dt>Related Academic Institutions</dt>
        <dd>{{ sortedPieceLinkList(academicInstitutions) }}</dd>
      </dl>
    {%- endif -%}

    {# media labs #}
    {%- set labs = apos.aemPieces.getRelatedMediaLabs(piece)-%}
    {%- if labs|length -%}
      <dl class="piece-props-list">
        <dt>Related Media Labs and Research Centers</dt>
        <dd>{{ sortedPieceLinkList(labs) }}</dd>
      </dl>
    {%- endif -%}
  {%- endif -%}

  {{ tags(piece) }}
{% endblock %}

{% block sidebar %}
  {% include "partials/people/sidebar-details-en.njk" %}
{% endblock %}
