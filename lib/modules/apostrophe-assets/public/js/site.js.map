{"version":3,"sources":["src/js/components/lang-switch.js","src/js/components/mega-menu.js","src/js/components/mobile-menu.js","src/js/components/skip-to-main-button.js","src/js/constants/breakpoint.js","src/js/constants/column-width.js","src/js/constants/content-width.js","src/js/constants/gutter-width.js","src/js/initialize.js","src/js/models/breakpoints-model.js","src/js/pages/analytics-downloads.js","src/js/utils/get-previous-element-sibling.js","src/js/utils/human-readable-file-size-si.js","src/js/utils/is-draft-mode.js"],"names":["currentLocale","forms","init","getCurrentLocale","getDOMElements","addEventListeners","length","console","warn","i","form","addEventListener","event","preventDefault","stopPropagation","langRadio","value","toLowerCase","window","location","locale","document","body","dataset","substr","getElementsByClassName","breakpointModel","require","getPreviousElementSibling","contentIds","headerNav","toggles","menuPanel","hideButtons","firstElement","lastElement","isVisible","currentContentId","animTimer","addBodyClickListener","addKeyListeners","addWindowResizeListener","addTogglesListeners","addHideButtonsListener","isElementInHeaderNav","contains","target","isElementInMenuPanel","hideMenu","key","shiftKey","then","setFocusToCaretButton","activeElement","focus","isMobileOrTablet","isMobile","getElementById","querySelectorAll","megaMenuToggle","button","isExpanded","getAttribute","clickedContentId","contentId","toggleLinkState","collapseAllNavButtons","hideAllSections","setAttribute","showSection","setFocusableElements","showMenu","exception","forEach","id","buttonId","caretButton","options","links","l","classList","remove","link","add","Promise","resolve","startAnimTimer","currentSection","focusable","section","duration","callback","clearAnimTimer","setTimeout","clearTimeout","openMenuButton","undefined","closeMenuButton","overlay","menu","onWindowResized","style","overflowY","overflowX","main","Breakpoint","PHONE","TABLET","DESKTOP","XL","XXL","HD","ColumnWidth","XS","SM","MD","ContentWidth","GutterWidth","modulesList","initAll","m","loadedModule","$","currentWidth","currentBreakpoint","detectBreakpoint","onresize","getCurrent","getCurrentColumnWidth","width","getCurrentGutterWidth","getWindowWidth","Math","max","scrollWidth","documentElement","offsetWidth","clientWidth","Types","ARTICLE","BANNER_AD","BOOK","EDUCATION","EVENT","MEDIA","ORGANIZATION","PERSON","PROJECT","data","env","local","prod","api","content","type","method","url","createdAt","stats","getBanners","getForwardLinks","isLocal","academiaDataButton","articlesDataButton","booksDataButton","eventsDataButton","mediaDataButton","orgsDataButton","peopleDataButton","projectsDataButton","piecesCreatedAtForm","piecesCreatedAtButton","fetchBannersDataButton","fetchLinksDataButton","template","templateElement","onclick","fetchDataForType","onsubmit","fetchContentPiecesCreatedAt","fetchBannersData","fetchForwardLinksData","isPending","xhr","XMLHttpRequest","onerror","xhrError","onload","status","statusText","promptToSave","response","generateFileName","xhrParams","getXHRParams","open","send","year","createdAtYear","month","createdAtMonth","fileName","toString","padStart","setRequestHeader","JSON","stringify","now","Date","filename","getFullYear","getMonth","getDate","getHours","getMinutes","typeData","find","element","baseUrl","blob","Blob","a","createElement","href","URL","createObjectURL","download","appendChild","click","removeChild","module","exports","attempt","maxAttempts","currentAttempt","sibling","previousSibling","nodeType","humanReadableFileSizeSI","bytes","units","exponent","floor","log","significand","pow","toFixed","isDraftMode","className","indexOf"],"mappings":"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","file":"/Volumes/Documents/Projects/arts-et-medias/www.arts-et-medias.net/lib/modules/apostrophe-assets/public/js/site.js","sourcesContent":["let currentLocale;\n\n// dom elements\nlet forms;\n\n\n// public api\nexport function init() {\n  getCurrentLocale();\n  getDOMElements();\n  addEventListeners();\n}\n\n\n// methods\nfunction addEventListeners() {\n  if (!forms || !forms.length) {\n    console.warn('Unable to handle lang switch form submissions');\n    return;\n  }\n\n  for (let i = 0; i < forms.length; i++) {\n    const form = forms[i];\n    form.addEventListener(\n      'submit',\n      (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const { langRadio } = form;\n        currentLocale = langRadio.value.toLowerCase();\n        window.location = `/${ currentLocale }/`;\n      }\n    );\n  }\n}\n\nfunction getCurrentLocale() {\n  const { locale } = document.body.dataset;\n  if (locale) {\n    currentLocale = locale.substr(0, 2).toLowerCase();\n  } else {\n    currentLocale = 'en';\n  }\n}\n\nfunction getDOMElements() {\n  forms = document.getElementsByClassName('lang-switch-form');\n}\n","const breakpointModel = require('../models/breakpoints-model');\nconst getPreviousElementSibling = require('../utils/get-previous-element-sibling');\n\n\n// id mapping\nconst contentIds = [\n  // v2\n  'mmDiscover',\n  'mmParticipate',\n  'mmVisit',\n  'mmRead',\n  'mmLearn',\n  // constant\n  'mmSearch',\n  'mmLangSwitch',\n];\n\n// dom elements\nlet headerNav;\nlet toggles;\nlet menuPanel;\nlet hideButtons;\nlet firstElement;\nlet lastElement;\n\n// state vars\nlet isVisible = false;\nlet currentContentId = null;\n\n// timer\nlet animTimer;\n\n\n// public api\nexport function init() {\n  getDOMElements();\n  addEventListeners();\n}\n\n\n// event handlers\nfunction addEventListeners() {\n  addBodyClickListener();\n  addKeyListeners();\n  addWindowResizeListener();\n  addTogglesListeners();\n  addHideButtonsListener();\n}\n\nfunction addBodyClickListener() {\n  if (!document || !document.body) {\n    console.warn('Unable to handle clicks on <body>');\n    return;\n  }\n\n  document.body.addEventListener(\n    'click',\n    (event) => {\n      if (!isVisible) {\n        return;\n      }\n\n      const isElementInHeaderNav = headerNav.contains(event.target);\n      const isElementInMenuPanel = menuPanel.contains(event.target);\n\n      if (!isElementInHeaderNav && !isElementInMenuPanel) {\n        hideMenu();\n      }\n    }\n  );\n}\n\nfunction addKeyListeners() {\n  document.addEventListener(\n    'keydown',\n    (event) => {\n      if (!isVisible) {\n        return;\n      }\n      const { key, shiftKey } = event;\n\n      if (key === 'Escape') {\n        hideMenu()\n          .then(\n            () => setFocusToCaretButton(currentContentId)\n          );\n      }\n\n      if (key === 'Tab') {\n        if (shiftKey) {\n          // tabbing backwards\n          if (document.activeElement === firstElement) {\n            event.preventDefault();\n            lastElement.focus();\n          }\n        } else {\n          // tabbing forward\n          if (document.activeElement === lastElement) {\n            menuPanel.focus();\n          }\n        }\n      }\n    }\n  );\n}\n\nfunction addWindowResizeListener() {\n  if (!window) {\n    console.warn('Unable to handle window resize');\n    return;\n  }\n  window.addEventListener(\n    'resize',\n    () => {\n      if (\n        (breakpointModel.isMobileOrTablet() && currentContentId !== 'mmLangSwitch')\n        || breakpointModel.isMobile()\n      ) {\n        hideMenu()\n          .then(\n            () => setFocusToCaretButton(currentContentId)\n          );\n      }\n    }\n  );\n}\n\n\n// dom methods\nfunction getDOMElements() {\n  headerNav = document.getElementById('headerNav');\n  toggles = document.querySelectorAll('.header-nav .nav-list .nav-item .nav-item-btn');\n\n  menuPanel = document.getElementById('megaMenuPanel');\n  hideButtons = document.querySelectorAll('.mega-menu .hide-mega-menu-button');\n}\n\n\n// nav items methods\nfunction addTogglesListeners() {\n  if (!toggles || !toggles.length) {\n    console.warn('Unable to handle nav items mouse events');\n    return;\n  }\n\n  for (let i = 0; i < toggles.length; i++) {\n    const megaMenuToggle = toggles[i];\n    megaMenuToggle.addEventListener(\n      'click',\n      (event) => {\n        const button = event.target;\n        const isExpanded = button.getAttribute('aria-expanded') === 'true';\n        const clickedContentId = button.dataset.contentId;\n\n        toggleLinkState({ button, isExpanded });\n        collapseAllNavButtons();\n        hideAllSections();\n        lastElement = null;\n\n        if (!isExpanded) {\n          // a11y\n          button.setAttribute('aria-expanded', true);\n\n          // content\n          currentContentId = clickedContentId;\n          showSection(currentContentId);\n\n          // dom\n          setFocusableElements();\n\n          // menu panel\n          showMenu()\n            .then(\n              () => menuPanel.focus()\n            );\n        } else if (isExpanded && button.dataset.contentId === currentContentId) {\n          hideMenu();\n\n        } else {\n          console.warn('Unable to toggle mega menu visibility');\n        }\n      }\n    );\n  }\n}\n\nfunction collapseAllNavButtons(exception) {\n  contentIds.forEach(id => {\n    if (exception && id === exception) {\n      return;\n    }\n    const buttonId = `${ id }Button`;\n    const button = document.getElementById(buttonId);\n    if (button) {\n      button.setAttribute('aria-expanded', false);\n    }\n  });\n}\n\nfunction setFocusToCaretButton(contentId) {\n  const caretButton = document.getElementById(`${ contentId }Button`);\n  if (caretButton) {\n    caretButton.focus();\n  } else {\n    console.warn(`Unable to get caret button with content id \"${ contentId }\"`);\n  }\n}\n\nfunction toggleLinkState(options) {\n  const { button, isExpanded } = options;\n\n  // disable all nav items\n  const links = headerNav.getElementsByClassName('nav-link');\n  for (let i = 0; i < links.length; i++) {\n    const l = links[i];\n    if (l) {\n      l.classList.remove('active');\n    }\n  }\n\n  // get link before caret\n  const link = getPreviousElementSibling(button);\n  if (!link) {\n    return;\n  }\n  if (!isExpanded) {\n    link.classList.add('active');\n  } else {\n    link.classList.remove('active');\n  }\n}\n\n\n// menu panel methods\nfunction addHideButtonsListener() {\n  if (!hideButtons || !hideButtons.length) {\n    console.warn('Unable to handle hide buttons\\' click');\n    return;\n  }\n\n  for (let i = 0; i < hideButtons.length; i++) {\n    const button = hideButtons[i];\n    button.addEventListener(\n      'click',\n      () => {\n        hideMenu()\n          .then(\n            () => {\n              // set focus back to nav item\n              const { contentId } = button.dataset;\n              setFocusToCaretButton(contentId);\n            }\n          );\n      }\n    );\n  }\n}\n\nfunction showMenu() {\n  menuPanel.classList.add('visible');\n\n  return new Promise(resolve => {\n    startAnimTimer(\n      750,\n      () => {\n        isVisible = true;\n        resolve();\n      }\n    );\n  });\n}\n\nfunction hideMenu() {\n  menuPanel.classList.remove('visible');\n  collapseAllNavButtons();\n\n  return new Promise(resolve => {\n    startAnimTimer(\n      500,\n      () => {\n        isVisible = false;\n        resolve();\n      }\n    );\n  });\n}\n\nfunction setFocusableElements() {\n  const currentSection = document.getElementById(currentContentId);\n  const focusable = currentSection.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])');\n  firstElement = focusable[0];\n  lastElement = focusable[focusable.length - 1];\n}\n\n\n// section methods\nfunction hideAllSections() {\n  contentIds.forEach(contentId => {\n    const section = document.getElementById(contentId);\n    if (section) {\n      section.classList.remove('visible');\n    } else {\n      console.warn(`Unable to get section with id ${ contentId }`);\n    }\n  });\n}\n\nfunction showSection(contentId) {\n  const section = document.getElementById(contentId);\n  if (section) {\n    section.classList.add('visible');\n  } else {\n    console.warn(`Unable to show section with id \"${ contentId }\"`);\n  }\n}\n\n\n// timer methods\nfunction startAnimTimer(duration, callback) {\n  clearAnimTimer();\n  animTimer = setTimeout(callback, duration);\n}\n\nfunction clearAnimTimer() {\n  clearTimeout(animTimer);\n  animTimer = null;\n}\n","// models\nconst breakpointModel = require('../models/breakpoints-model');\n\n// dom elements\nlet openMenuButton = undefined;\nlet closeMenuButton = undefined;\nlet overlay = undefined;\nlet menu = undefined;\n\n// vars\nlet isVisible = false;\n\n\n// public api\nexport function init() {\n  getDOMElements();\n  addEventListeners();\n}\n\n\n// method definitions\nfunction addEventListeners() {\n  openMenuButton.addEventListener('click', showMenu);\n  closeMenuButton.addEventListener('click', hideMenu);\n  overlay.addEventListener('click', hideMenu);\n\n  window.addEventListener('resize', onWindowResized);\n}\n\nfunction getDOMElements() {\n  closeMenuButton = document.getElementById('closeMobileMenuButton');\n  openMenuButton = document.getElementById('openMobileMenuButton');\n  menu = document.getElementById('mobileMenu');\n  overlay = document.getElementById('overlay');\n}\n\nfunction hideMenu() {\n  menu.classList.remove('visible');\n  overlay.classList.remove('visible');\n\n  // allow scrolling\n  document.body.style.overflowY = 'auto';\n  document.body.style.overflowX = 'hidden';\n\n  isVisible = false;\n}\n\nfunction showMenu() {\n  menu.classList.add('visible');\n  overlay.classList.add('visible');\n\n  // disallow scrolling\n  document.body.style.overflowY = 'hidden';\n  document.body.style.overflowX = 'hidden';\n\n  isVisible = true;\n}\n\nfunction onWindowResized() {\n  if (!breakpointModel.isMobile() && isVisible) {\n    hideMenu();\n  }\n}\n","// dom elements\nlet button;\nlet main;\n\nexport function init() {\n  // get dom elements\n  button = document.getElementById('skipToMainBtn');\n  main = document.getElementById('main');\n\n  // event handlers\n  button.addEventListener(\n    'click',\n    (event) => {\n      main.focus();\n    }\n  );\n}\n","const Breakpoint = {\n  PHONE: 375,\n  TABLET: 768,\n  DESKTOP: 1024,\n  XL: 1280,\n  XXL: 1440,\n  HD: 1920,\n};\nexport default Breakpoint;\n","// match src/styles/common/_variables.scss\nconst ColumnWidth = {\n  XS: 40, // mobile\n  SM: 35, // tablet\n  MD: 50, // desktop\n  XL: 60,\n  XXL: 70,\n  HD: 80,\n};\nexport default ColumnWidth;\n","// match src/styles/common/_variables.scss\nconst ContentWidth = {\n  PHONE: 320,\n  TABLET: 695,\n  DESKTOP: 930,\n  XL: 1105,\n  XXL: 1280,\n  HD: 1510,\n};\nexport default ContentWidth;\n","// match src/styles/common/_variables.scss\nconst GutterWidth = {\n  XS: 16, // mobile\n  SM: 25, // tablet\n  MD: 30, // desktop\n  XL: 35,\n  XXL: 40,\n  HD: 50,\n};\nexport default GutterWidth;\n","const modulesList = [\n  // models\n  'models/breakpoints-model',\n  // components\n  'components/mega-menu',\n  'components/lang-switch',\n  'components/mobile-menu',\n  'components/skip-to-main-button',\n  // pages\n  'pages/analytics-downloads',\n];\n\n\n// methods definitions\nfunction initAll() {\n  // import all *.js files and `init()` them\n  modulesList.forEach((m) => {\n    // require module\n    const loadedModule = require(`./${ m }`);\n\n    // init() if method exists\n    if ((typeof loadedModule.init) === 'function') {\n      loadedModule.init();\n    }\n  });\n}\n\n// init all on page load\n$(initAll);\n","// constants\nconst Breakpoint = require('../constants/breakpoint').default;\nconst ColumnWidth = require('../constants/column-width').default;\nconst GutterWidth = require('../constants/gutter-width').default;\n\n// vars\nlet currentWidth = undefined;\nlet currentBreakpoint = undefined;\n\n\n// public api\nexport function init() {\n  detectBreakpoint();\n  window.onresize = onWindowResized;\n}\n\nexport function getCurrent() {\n  return currentBreakpoint;\n}\n\nexport function getCurrentColumnWidth() {\n  let width = -1;\n  switch (currentBreakpoint) {\n  case Breakpoint.PHONE:\n    width = ColumnWidth.XS;\n    break;\n\n  case Breakpoint.TABLET:\n    width = ColumnWidth.SM;\n    break;\n\n  case Breakpoint.DESKTOP:\n    width = ColumnWidth.MD;\n    break;\n\n  case Breakpoint.XL:\n    width = ColumnWidth.XL;\n    break;\n\n  case Breakpoint.XXL:\n    width = ColumnWidth.XXL;\n    break;\n  }\n  return width;\n}\n\nexport function getCurrentGutterWidth() {\n  let width = -1;\n  switch (currentBreakpoint) {\n  case Breakpoint.PHONE:\n    width = GutterWidth.XS;\n    break;\n\n  case Breakpoint.TABLET:\n    width = GutterWidth.SM;\n    break;\n\n  case Breakpoint.DESKTOP:\n    width = GutterWidth.MD;\n    break;\n\n  case Breakpoint.XL:\n    width = GutterWidth.XL;\n    break;\n\n  case Breakpoint.XXL:\n    width = GutterWidth.XXL;\n    break;\n  }\n  return width;\n}\n\nexport function isMobile() {\n  return currentBreakpoint === Breakpoint.PHONE;\n}\n\nexport function isMobileOrTablet() {\n  return currentBreakpoint === Breakpoint.PHONE || currentBreakpoint === Breakpoint.TABLET;\n}\n\n\n// private methods\nfunction detectBreakpoint() {\n  currentWidth = getWindowWidth();\n\n  if (currentWidth >= Breakpoint.DESKTOP) {\n    currentBreakpoint = Breakpoint.DESKTOP;\n\n  } else if (currentWidth >= Breakpoint.TABLET) {\n    currentBreakpoint = Breakpoint.TABLET;\n\n  } else if (currentWidth >= Breakpoint.XL) {\n    currentBreakpoint = Breakpoint.XL;\n\n  } else if (currentWidth >= Breakpoint.XXL) {\n    currentBreakpoint = Breakpoint.XXL;\n\n  } else {\n    currentBreakpoint = Breakpoint.PHONE;\n  }\n}\n\nfunction getWindowWidth() {\n  return Math.max(\n    document.body.scrollWidth,\n    document.documentElement.scrollWidth,\n    document.body.offsetWidth,\n    document.documentElement.offsetWidth,\n    document.documentElement.clientWidth\n  );\n  // from https://stackoverflow.com/questions/1038727/how-to-get-browser-width-using-javascript-code\n}\n\nfunction onWindowResized() {\n  detectBreakpoint();\n}\n","// consts\nconst Types = {\n  ARTICLE: 'article',\n  BANNER_AD: 'banner-ad',\n  BOOK: 'book',\n  EDUCATION: 'education',\n  EVENT: 'event',\n  MEDIA: 'media',\n  ORGANIZATION: 'organization',\n  PERSON: 'person',\n  PROJECT: 'project',\n};\n\n// data\nconst data = {\n  env: {\n    local: 'http://localhost:3232',\n    prod: '/api',\n  },\n  api: {\n    content: [\n      {\n        type: Types.ARTICLE,\n        method: 'GET',\n        url: '/content/get-articles',\n      },\n      {\n        type: Types.BOOK,\n        method: 'GET',\n        url: '/content/get-books',\n      },\n      {\n        type: Types.EDUCATION,\n        method: 'GET',\n        url: '/content/get-academia',\n      },\n      {\n        type: Types.EVENT,\n        method: 'GET',\n        url: '/content/get-events',\n      },\n      {\n        type: Types.MEDIA,\n        method: 'GET',\n        url: '/content/get-media',\n      },\n      {\n        type: Types.ORGANIZATION,\n        method: 'GET',\n        url: '/content/get-organizations',\n      },\n      {\n        type: Types.PERSON,\n        method: 'GET',\n        url: '/content/get-people',\n      },\n      {\n        type: Types.PROJECT,\n        method: 'GET',\n        url: '/content/get-projects',\n      },\n    ],\n    createdAt: {\n      method: 'POST',\n      url: '/content/created-at',\n    },\n    stats: {\n      getBanners: {\n        method: 'GET',\n        url: '/stats/get-banners',\n      },\n      getForwardLinks: {\n        method: 'GET',\n        url: '/stats/get-forward-links',\n      },\n    },\n  },\n};\n\n// vars\nlet isLocal;\n\n// dom elements\nlet academiaDataButton;\nlet articlesDataButton;\nlet booksDataButton;\nlet eventsDataButton;\nlet mediaDataButton;\nlet orgsDataButton;\nlet peopleDataButton;\nlet projectsDataButton;\n\nlet piecesCreatedAtForm;\nlet piecesCreatedAtButton;\n\nlet fetchBannersDataButton;\nlet fetchLinksDataButton;\n\n\n// public api\nexport function init() {\n  const template = document.getElementsByClassName('analytics-downloads-template');\n\n  // quick exit if wrong page\n  if (!template.length) {\n    return;\n  }\n\n  // check if localhost\n  const templateElement = template[0];\n  isLocal = templateElement.dataset.isLocal === 'true';\n\n  // setup\n  getDOMElements();\n  addEventListeners();\n}\n\n\n// private methods\nfunction getDOMElements() {\n  // content pieces data\n  academiaDataButton = document.getElementById('academiaDataButton');\n  articlesDataButton = document.getElementById('articlesDataButton');\n  booksDataButton = document.getElementById('booksDataButton');\n  eventsDataButton = document.getElementById('eventsDataButton');\n  mediaDataButton = document.getElementById('mediaDataButton');\n  orgsDataButton = document.getElementById('orgsDataButton');\n  peopleDataButton = document.getElementById('peopleDataButton');\n  projectsDataButton = document.getElementById('projectsDataButton');\n\n  // pieces added at month\n  piecesCreatedAtForm = document.getElementById('piecesCreatedAtForm');\n  piecesCreatedAtButton = document.getElementById('piecesCreatedAtButton');\n\n  // stats\n  fetchBannersDataButton = document.getElementById('fetchBannersDataButton');\n  fetchLinksDataButton = document.getElementById('fetchLinksDataButton');\n}\n\nfunction addEventListeners() {\n  // content pieces data\n  academiaDataButton.onclick = event => fetchDataForType(event, Types.EDUCATION);\n  articlesDataButton.onclick = event => fetchDataForType(event, Types.ARTICLE);\n  booksDataButton.onclick = event => fetchDataForType(event, Types.BOOK);\n  eventsDataButton.onclick = event => fetchDataForType(event, Types.EVENT);\n  mediaDataButton.onclick = event => fetchDataForType(event, Types.MEDIA);\n  orgsDataButton.onclick = event => fetchDataForType(event, Types.ORGANIZATION);\n  peopleDataButton.onclick = event => fetchDataForType(event, Types.PERSON);\n  projectsDataButton.onclick = event => fetchDataForType(event, Types.PROJECT);\n\n  // pieces added at month\n  piecesCreatedAtForm.onsubmit = fetchContentPiecesCreatedAt;\n\n  // stats\n  fetchBannersDataButton.onclick = fetchBannersData;\n  fetchLinksDataButton.onclick = fetchForwardLinksData;\n}\n\nfunction fetchDataForType(event, type) {\n  event.target.dataset.isPending = true;\n\n  const xhr = new XMLHttpRequest();\n\n  xhr.onerror = () => {\n    xhrError(xhr);\n    event.target.dataset.isPending = false;\n  };\n\n  xhr.onload = () => {\n    event.target.dataset.isPending = false;\n    if (xhr.status !== 200) {\n      console.warn('unable to load:', xhr.statusText);\n      return;\n    }\n    promptToSave(xhr.response, `${generateFileName(type)}.tsv`);\n  };\n\n  const xhrParams = getXHRParams(type);\n  xhr.open(xhrParams.method, xhrParams.url);\n\n  xhr.send();\n}\n\nfunction fetchContentPiecesCreatedAt(event) {\n  piecesCreatedAtButton.dataset.isPending = true;\n\n  event.preventDefault();\n  event.stopPropagation();\n\n  // form values\n  const year = piecesCreatedAtForm.createdAtYear.value;\n  const month = piecesCreatedAtForm.createdAtMonth.value;\n\n  const xhr = new XMLHttpRequest();\n\n  xhr.onerror = () => {\n    xhrError(xhr);\n    piecesCreatedAtButton.dataset.isPending = false;\n  };\n\n  xhr.onload = () => {\n    piecesCreatedAtButton.dataset.isPending = false;\n    if (xhr.status !== 200) {\n      console.warn('unable to load:', xhr.statusText);\n      return;\n    }\n    const fileName = generateFileName(`during-${year}-${(month + 1).toString().padStart(2, '0')}`);\n    promptToSave(xhr.response, `${fileName}.tsv`);\n  };\n\n  // open request\n  const method = data.api.createdAt.method;\n  const url = `${data.env.local}${data.api.createdAt.url}`;\n  xhr.open(method, url);\n\n  // set `Content-Type` header\n  xhr.setRequestHeader('Content-type', 'application/json;charset=UTF-8');\n\n  // send data\n  xhr.send(JSON.stringify({ year, month }));\n}\n\nfunction fetchBannersData() {\n  fetchBannersDataButton.dataset.isPending = true;\n\n  const xhr = new XMLHttpRequest();\n\n  xhr.onerror = () => {\n    xhrError(xhr);\n    fetchBannersDataButton.dataset.isPending = false;\n  };\n\n  xhr.onload = () => {\n    fetchBannersDataButton.dataset.isPending = false;\n    if (xhr.status !== 200) {\n      console.warn('unable to load:', xhr.statusText);\n      return;\n    }\n    promptToSave(xhr.response, `${generateFileName('banners')}.tsv`);\n  };\n\n  const method = data.api.stats.getBanners.method;\n  const url = `${data.env.local}${data.api.stats.getBanners.url}`;\n  xhr.open(method, url);\n\n  xhr.send();\n}\n\nfunction fetchForwardLinksData() {\n  fetchLinksDataButton.dataset.isPending = true;\n\n  const xhr = new XMLHttpRequest();\n\n  xhr.onerror = () => {\n    xhrError(xhr);\n    fetchLinksDataButton.dataset.isPending = false;\n  };\n\n  xhr.onload = () => {\n    fetchLinksDataButton.dataset.isPending = false;\n    if (xhr.status !== 200) {\n      console.warn('unable to load:', xhr.statusText);\n      return;\n    }\n    promptToSave(xhr.response, `${generateFileName('forward-links')}.tsv`);\n  };\n\n  const method = data.api.stats.getForwardLinks.method;\n  const url = `${data.env.local}${data.api.stats.getForwardLinks.url}`;\n  xhr.open(method, url);\n\n  xhr.send();\n}\n\n\n// utils\nfunction generateFileName(type) {\n  const now = new Date();\n  const filename = `aem-${type}-${now.getFullYear()}`\n    + `${(now.getMonth() + 1).toString().padStart(2, '0')}`\n    + `${now.getDate().toString().padStart(2, '0')}`\n    + '-'\n    + `${now.getHours().toString().padStart(2, '0')}`\n    + `${now.getMinutes().toString().padStart(2, '0')}`;\n  return filename;\n}\n\nfunction getXHRParams(type) {\n  const typeData = data.api.content.find(element => element.type === type);\n  const baseUrl = (isLocal) ? data.env.local : data.env.prod;\n\n  return {\n    url: `${baseUrl}${typeData.url}`,\n    method: typeData.method,\n  };\n}\n\nfunction promptToSave(response, fileName) {\n  const blob = new Blob([response], { type: 'application/text' });\n\n  const a = document.createElement('a');\n  a.href = window.URL.createObjectURL(blob);\n  a.download = fileName;\n\n  document.body.appendChild(a);\n\n  a.click();\n\n  document.body.removeChild(a);\n}\n\nfunction xhrError(xhr) {\n  console.warn('error loading:', xhr.statusText);\n}\n","module.exports = getPreviousElementSibling;\n\n\nfunction getPreviousElementSibling(element, attempt) {\n  if (!element) {\n    return null;\n  }\n\n  var maxAttempts = 10; // safely stop recursivity\n  var currentAttempt = attempt | 0;\n\n  if (currentAttempt >= maxAttempts) {\n    return null;\n  }\n\n  var sibling = element.previousSibling;\n  currentAttempt++;\n\n  if (!sibling || sibling.nodeType !== 1) {\n    return getPreviousElementSibling(sibling, currentAttempt);\n  }\n\n  return sibling;\n}\n","module.exports = humanReadableFileSizeSI;\n\n\nfunction humanReadableFileSizeSI(bytes) {\n  const units = ['', 'K', 'M', 'G', 'T', 'P', 'E', 'Z', 'Y'];\n\n  const exponent = Math.floor(Math.log(bytes) / Math.log(1024));\n  const significand = (bytes / Math.pow(1024, exponent)).toFixed(1);\n\n  return `${significand} ${units[exponent]}B`;\n}\n","module.exports = isDraftMode;\n\n\nfunction isDraftMode() {\n  let response = false;\n\n  const { classList } = document.body;\n\n  if (!classList) {\n    return response;\n  }\n\n  for (let i = 0; i < classList.length; i++) {\n    const className = classList[i];\n    if (className && className.indexOf('draft') > -1) {\n      response = true;\n    }\n  }\n\n  return response;\n}\n"]}