{% extends "layouts/pieceDetailsLayout.njk" %}

{%- from 'macros/content-section.njk' import contentSection -%}
{%- from 'macros/hero-image.njk' import heroImage -%}
{%- from 'macros/metadata.njk' import articleMetaData -%}
{%- from 'macros/piece-details.njk' import relatedOrganizations, relatedPieces, tags -%}
{%- from 'macros/piece-link-list.njk' import pieceLinkList -%}


{%- set piece = data.piece -%}

{% block title %}
  {{ piece.title }} - Articles | Arts et MÃ©dias
{% endblock %}

{% block metadata %}
  {%- set author = apos.aemAuthors.getListFromArticle(piece) -%}
  {{
    articleMetaData({
      title: piece.title + ', by ' + author,
      author: author,
      publicationDate: apos.aemPieces.getISODate(piece),
      description: piece.shortDescription,
      heroImage: piece.heroImage,
      section: apos.aemPieces.getArticleSection(piece),
      url: piece._url,
      baseUrl: data.baseUrl
    })
  }}
{% endblock %}

{% block mainAdditionalClasses %}article-details{% endblock %}

{% block subheading %}
  <div class="subheading">
    <h2 class="sr-only">Authors</h2>
    {{ pieceLinkList(piece._originalAuthor) }}, {{ apos.aem.formatDate(piece.publicationDate) }}
  </div>
{% endblock %}

{% block pageContent %}
  {{ heroImage(piece, true) }}

  <div class="description rich-description">
    {{ contentSection(piece) }}
  </div>

  {%- if piece.isTranslation -%}
    {%- set originalLang = apos.aemLocalization.getLanguagesFrom(piece.originalLang) -%}
    <div class="translation">
      Translated from {{ originalLang }} by {{ pieceLinkList(piece._translator) }}.
    </div>
  {%- endif -%}

  {%- set isMention = piece.articleType === 'mention' -%}
  {%- if isMention -%}
    <div class="mention">
      <p class="mention-notes">This article was not originally published on this site.</p>
      <a
        class="website-cta"
        href="{{ piece.externalLink }}"
        target="_blank"
        rel="noopener noreferrer"
      >Read complete article</a>
    </div>
  {%- endif -%}

  <hr class="separator"/>

  {%- set relatedArticles = apos.aemArrays.merge(piece._relatedArticles, piece._articles) -%}
  {{ relatedPieces('Related Articles', relatedArticles) }}

  {{ relatedPieces('Related Books', piece._relatedBooks) }}

  {{ relatedPieces('Related Media', piece._relatedMedia) }}

  {{ relatedPieces('Related People', piece._relatedPeople) }}

  {{ relatedOrganizations(piece._relatedOrganizations) }}

  {{ tags(piece) }}
{% endblock %}

{% block sidebar %}
  {% include "partials/articles/sidebar-en.njk" %}
{% endblock %}
