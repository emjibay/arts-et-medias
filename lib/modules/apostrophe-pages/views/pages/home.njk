{% extends "layouts/layout.njk" %}

{%- from 'macros/metadata.njk' import descriptiveMetaData -%}
{%- from 'macros/piece-index.njk' import articleList, eventList, bookList, projectList -%}


{% macro seeAllCTA(type) %}
  <div class="see-all-cta">
    <a
      class="website-cta"
      href="{{ __(type + '|url') }}"
    >{{ __(type + '|seeAllCTA') }}</a>
  </div>
{% endmacro %}

{% macro seeAllArticlesCTA() %}
  {{ seeAllCTA('articles') }}
{% endmacro %}

{% macro seeAllEventsCTA() %}
  {{ seeAllCTA('events') }}
{% endmacro %}

{% macro seeAllProjectsCTA() %}
  {{ seeAllCTA('projects') }}
{% endmacro %}

{% macro seeAllBooksCTA() %}
  {{ seeAllCTA('books') }}
{% endmacro %}


{% block title %}
  {{ __('global|shortDescription') }} | {{ __('global|title') }}
{% endblock %}

{% block metadata %}
  {{
    descriptiveMetaData({
      title: __('global|title'),
      description: __('global|description'),
      url: data.page._url,
      baseUrl: data.baseUrl
    })
  }}
{% endblock %}

{% block main %}
  <div class="page home">
    <div class="content">
      <main id="main">
        <article>
          <h1 class="sr-only">{{ __('pages|home|title') }}</h1>

          <div class="page-content">
            <section class="articles-section">
              <div class="section-heading">
                <h2 class="h2">{{ __('home|newsHeading') }}</h2>
                {{ seeAllArticlesCTA() }}
              </div>

              <div class="featured-article">
                {% include "partials/articles/featured.njk" %}
              </div>

              <div class="recently-added-articles">
                <h3 class="latest-pieces-heading">
                  {{ __('articles|recentlyAdded') }}
                </h3>
                {%-
                  set recentArticles = apos.aemPieces.getFirstN(
                    data.articlesByMostRecent,
                    3
                  )
                -%}
                {{ articleList(recentArticles) }}
              </div>

              {% include "partials/home/sidebar-en.njk" %}

              {{ seeAllArticlesCTA() }}
            </section>

            <section class="events-section">
              <div class="section-heading">
                <h2 class="h2">{{ __('events|heading') }}</h2>
                {{ seeAllEventsCTA() }}
              </div>

              <div class="featured-piece">
                {% include "partials/events/featured.njk" %}
              </div>

              <div class="latest-pieces">
                <h3 class="latest-pieces-heading">{{ __('events|categories|festivals|next') }}</h3>
                {%-
                  set nextFestivals = apos.aemPieces.getFirstTwoWithTags(
                    data.orderedEvents,
                    ['festival']
                  )
                -%}
                {{ eventList(nextFestivals) }}
              </div>

              {{ seeAllEventsCTA() }}
            </section>

            <section class="projects-section">
              <div class="section-heading">
                <h2 class="h2">{{ __('projects|heading') }}</h2>
                {{ seeAllProjectsCTA() }}
              </div>

              <div class="featured-piece">
                {% include "partials/projects/featured.njk" %}
              </div>

              <div class="latest-pieces">
                <h3 class="latest-pieces-heading">{{ __('projects|recentlyAdded') }}</h3>
                {%-
                  set recentProjects = apos.aemPieces.getFirstTwo(
                    data.projectsByMostRecent
                  )
                -%}
                {{ projectList(recentProjects) }}
              </div>

              {{ seeAllProjectsCTA() }}
            </section>

            <section class="books-section">
              <div class="section-heading">
                <h2 class="h2">{{ __('books|heading') }}</h2>
                {{ seeAllBooksCTA() }}
              </div>

              <div class="featured-piece">
                {% include "partials/books/featured.njk" %}
              </div>

              <div class="latest-pieces">
                <h3 class="latest-pieces-heading">{{ __('books|recentlyAdded') }}</h3>
                {%-
                  set recentBooks = apos.aemPieces.getFirstTwo(
                    data.booksByMostRecent
                  )
                -%}
                {{ bookList(recentBooks) }}
              </div>

              {{ seeAllBooksCTA() }}
            </section>
          </div>

        </article>
      </main>
    </div>
  </div>
{% endblock %}
