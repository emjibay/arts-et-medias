{% extends "layouts/indexLayout.njk" %}

{%- from 'macros/banner-ad.njk' import leaderboard -%}
{%- from 'macros/piece-index.njk' import recentlyAdded, recentlyAddedProjects -%}


{% macro seeAllCTA(label, url) %}
  <div class="see-all-cta">
    <a
      class="website-cta"
      href="{{ url }}"
    >{{ label }}</a>
  </div>
{% endmacro %}

{% macro recentlyAddedMedia(type, category) %}
  {%-
    set mediaItems = apos.aemPieces.getMediaWithType(
      data.mediaByMostRecent,
      type
    )
  -%}
  {%- set cat = 'media|categories|' + category + '|' -%}
  {{
    recentlyAdded(
      __(cat + 'recentlyAdded'),
      mediaItems
    )
  }}
  {{
    seeAllCTA(
      __(cat + 'seeAllCTA'),
      __(cat + 'url')
    )
  }}
{% endmacro %}


{% block title %}
  {{ apos.aemSeo.buildSimplePageTitle(__, data.page.title) }}
{% endblock %}

{% block mainAdditionalClasses %}media-index{% endblock %}

{% block pageTitle %}{{ data.page.title }}{% endblock %}

{% block advertisementBeforeMain %}
  {% include "partials/media/top-leaderboard.njk" %}
{% endblock %}

{% block pageContent %}
  {#- projects -#}
  {{
    recentlyAddedProjects(
      __('projects|recentlyAdded'),
      data.projectsByMostRecent,
      []
    )
  }}
  <div class="see-all-cta">
    {{
      seeAllCTA(
        __('projects|seeAllCTA'),
        __('projects|url')
      )
    }}
  </div>
  {#- projects end -#}

  {#- books -#}
  {{
    recentlyAdded(
      __('books|recentlyAdded'),
      data.booksByMostRecent
    )
  }}
  <div class="see-all-cta">
    {{
      seeAllCTA(
        __('books|seeAllCTA'),
        __('books|url')
      )
    }}
  </div>
  {#- books end -#}

  {#- media types -#}
  {{ recentlyAddedMedia('magazine', 'magazines') }}

  {{ recentlyAddedMedia('blog', 'blogs') }}

  {{ recentlyAddedMedia('website', 'websites') }}
  {#- media types end -#}
{% endblock %}

{% block sidebar %}
  {% include "partials/media/sidebar.njk" %}
{% endblock %}
