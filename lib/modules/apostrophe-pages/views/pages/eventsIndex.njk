{% extends "layouts/indexLayout.njk" %}

{%- from 'macros/piece-index.njk' import recentlyAddedEvents -%}


{%- set locale = apos.aemI18n.getSanitizedLocale(data) -%}


{% macro seeAllCTA(label, url) %}
  <div class="see-all-cta">
    <a
      class="website-cta"
      href="{{ ur }}"
    >{{ label }}</a>
  </div>
{% endmacro %}

{% macro eventList(category) %}
  {%- set cat = 'events|categories|' + category + '|' -%}

  {{
    recentlyAddedEvents(
      __(cat + 'next'),
      data.orderedEvents,
      __(cat + 'tags'),
      locale
    )
  }}
  {{
    recentlyAddedEvents(
      __(cat + 'recentlyAdded'),
      data.eventsByMostRecent,
      __(cat + 'tags'),
      locale
    )
  }}
  <div class="see-all-cta">
    {{
      seeAllCTA(
        __(cat + 'seeAllCTA'),
        __(cat + 'url')
      )
    }}
  </div>
{% endmacro %}


{% block title %}
  {{ apos.aemSeo.buildSimplePageTitle(__, data.page.title) }}
{% endblock %}

{% block mainAdditionalClasses %}event-index{% endblock %}

{% block pageContent %}
  {% include "partials/events/featured.njk" %}

  {{ eventList('festivals') }}

  {{ eventList('conferences') }}

  {{ eventList('workshops') }}
{% endblock %}

{% block sidebar %}
  {% include "partials/events/sidebar-no-feature-en.njk" %}
{% endblock %}
