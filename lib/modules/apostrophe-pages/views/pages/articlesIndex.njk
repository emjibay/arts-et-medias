{% extends "layouts/indexLayout.njk" %}


{%- from 'macros/banner-ad.njk' import inContextLeaderboard, mobileBannerAds -%}
{%- from 'macros/cta.njk' import seeAllCTA -%}
{%- from 'macros/piece-index.njk' import recentlyAddedArticles -%}


{%- set locale = apos.aemI18n.getSanitizedLocale(data) -%}
{%- set leaderboardOptions = { data: data, propName: 'articlesLeaderboard' } -%}
{%- set areLeaderboardsVisible = apos.aemBannerAds.areVisible(leaderboardOptions) -%}


{% macro articleList(category) %}
  {%- set cat = 'articles|categories|' + category + '|' -%}

  {%-
    set recentlyAdded = apos.aemPieces.getFirstTwoWithTags(
      data.articlesByMostRecent,
      __(cat + 'tags')
    )
  -%}

  {%- if (recentlyAdded and recentlyAdded|length > 0) -%}
    {{
      recentlyAddedArticles(
        __(cat + 'recentlyAdded'),
        recentlyAdded,
        locale
      )
    }}

    {{ seeAllCTA(__(cat + 'seeAllCTA'), __(cat + 'url')) }}
  {%- endif -%}
{% endmacro %}


{% block title %}
  {{ apos.aemSeo.buildSimplePageTitle(__, data.page.title) }}
{% endblock %}

{% block mainAdditionalClasses %}articles-index{% endblock %}

{% block advertisementBeforeMain %}
  {%- if areLeaderboardsVisible -%}
    {{ inContextLeaderboard(leaderboardOptions, { location: 'before' }) }}
  {%- endif -%}
{% endblock %}

{% block pageContent %}
  {% include "partials/articles/featured.njk" %}

  {{
    mobileBannerAds({
      data: data,
      propName: 'articlesSidebarBanners1'
    })
  }}

  {{ articleList('news') }}

  {{
    mobileBannerAds({
      data: data,
      propName: 'articlesSidebarBanners2'
    })
  }}

  {{ articleList('essays') }}

  {{ articleList('reviews') }}

  {{ articleList('interviews') }}

  {{ articleList('academicPapers') }}

  {{ articleList('conferenceProceedings') }}
{% endblock %}

{% block sidebar %}
  {% include "partials/articles/sidebar-no-feature.njk" %}
{% endblock %}
