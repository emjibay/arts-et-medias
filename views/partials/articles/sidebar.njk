{%- from 'macros/banner-ad.njk' import containedSidebarBanners -%}


{%- set hasFeaturedArticle = apos.aemPieces.hasFeaturedArticle(data) -%}
{%- set isDraftMode = apos.aemUtils.isDraftMode(data) -%}


<aside class="sidebar">
  <article>
    {{
      containedSidebarBanners({
        data: data,
        propName: 'articlesSidebarBanners1',
        hasTopSeparator: false,
        hasBottomSeparator: false
      })
    }}

    {%- if hasFeaturedArticle or isDraftMode -%}
      {% include "partials/articles/featured.njk" %}
      <hr class="separator no-mb" />
    {%- endif -%}

    {{
      containedSidebarBanners({
        data: data,
        propName: 'articlesSidebarBanners2',
        hasTopSeparator: false,
        hasBottomSeparator: false
      })
    }}

    {{
      containedSidebarBanners({
        data: data,
        propName: 'articlesSidebarBanners3',
        hasTopSeparator: false,
        hasBottomSeparator: true
      })
    }}

    {% include "partials/articles/in-this-section.njk" %}
    {% include "partials/books/related.njk" %}

    <hr class="separator" />

    {% include "partials/articles/search.njk" %}

    <hr class="separator" />

    {% include "partials/sidebar/help-cta.njk" %}
  </article>
</aside>
