{%- from 'macros/featured-piece.njk' import featuredArticle -%}


{% macro seeAllCTA(propName) %}
  <div class="see-all-cta">
    {{
      apos.singleton(
        data.global,
        propName,
        'aem-link'
      )
    }}
  </div>
{% endmacro %}

{%- macro articleList(heading, pieces, tags, ctaPropName) -%}
  {%- set list = apos.aemPieces.getWithTags(pieces, tags) -%}
  {%- set list = apos.aemArrays.truncate(list, 2) -%}

  <div class="list-container">
    <div class="list-heading">{{ heading }}</div>
    <ul class="list">
      {% for listItem in list %}
        <li>
          <a
            class="list-item"
            href="{{ listItem._url }}"
          >{{ listItem.title }}</a>
        </li>
      {% endfor %}
    </ul>
    {{ seeAllCTA(ctaPropName) }}
  </div>
{%- endmacro -%}


<section
  id="mmArticles"
  class="articles-section"
>
  <div class="mm-col">
    {% include "partials/articles/featured.njk" %}
  </div>

  <div class="mm-col">
    {%- set latestArticle = data.articlesByMostRecent[0] -%}
    {{ featuredArticle(latestArticle, 'Latest Article Added') }}
  </div>

  <div class="mm-col">
    {{
      articleList(
        'Recently Added News',
        data.articlesByMostRecent,
        ['news'],
        'seeAllNewsCTA'
      )
    }}

    {{
      articleList(
        'Recently Added Reviews',
        data.articlesByMostRecent,
        ['review'],
        'seeAllReviewsCTA'
      )
    }}
  </div>

  <div class="mm-col">
    {{
      articleList(
        'Recently Added Essays',
        data.articlesByMostRecent,
        ['essay', 'editorial'],
        'seeAllEssaysCTA'
      )
    }}

    {{
      articleList(
        'Recently Added Interviews',
        data.articlesByMostRecent,
        ['interview'],
        'seeAllInterviewsCTA'
      )
    }}
  </div>

  <div class="mm-footer">
    <hr class="separator" />

    <button
      class="hide-mega-menu-button"
    >Hide menu</button>

    {{Â seeAllCTA('seeAllArticlesCTA') }}
  </div>
</section>
